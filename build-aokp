#!/bin/bash

BUILD_DIR=/home/$USER/jb-aokp

export USE_CCACHE=1
export CCACHE_DIR=/home/$USER/.ccache

ACTION=$1
DEVICE=$2

cd $BUILD_DIR
. build/envsetup.sh

function sync {
    repo sync -j32
}

function build {
    ccache -M 40G
    brunch $ACTION
    find . -name aokp_${ACTION}_\*.zip -exec scp {} home:/home/will/updates/ \; -exec echo "Successfully copied to Dropbox..." \;
}

function clean {
    lunch aokp_$DEVICE-userdebug
    make clean -j16
}

function clobber {
    make clobber -j16
}

if [ "$ACTION" = "sync" ];
then
    sync
elif [ "$ACTION" = "clean" ];
then
    clean
elif [ "$ACTION" = "clobber" ];
then
    clobber
else
    build
fi
